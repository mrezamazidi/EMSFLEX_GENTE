from EMSFLEX_Robust import EMSFLEXfunc
from EMSEnergy import EMSEnergyfunc
from EMSFLEX_Provide import EMSFLEX_providefunc

# Spot_market data
spot_price = [0.221990000000000, 0.228250000000000, 0.218800000000000,
              0.207140000000000, 0.200660000000000, 0.193510000000000,
              0.208570000000000, 0.202200000000000, 0.220230000000000,
              0.235400000000000, 0.241890000000000, 0.284770000000000,
              0.507080000000000, 0.549960000000000, 0.439800000000000,
              0.253430000000000, 0.545680000000000, 1.04067000000000,
              1.48508000000000, 0.271790000000000, 0.212750000000000,
              0.205930000000000, 0.182300000000000, 0.159320000000000]

# Flex price
flex_price = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
              sum(spot_price) / 24, sum(spot_price) / 24, sum(spot_price) / 24,
              sum(spot_price) / 24, sum(spot_price) / 24, sum(spot_price) / 24,
              sum(spot_price) / 24, sum(spot_price) / 24, sum(spot_price) / 24,
              0, 0, 0, 0]

# flex_price = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
#              max(spot_price), max(spot_price), max(spot_price),
#              max(spot_price), max(spot_price), max(spot_price),
#              max(spot_price), max(spot_price), max(spot_price),
#              0, 0, 0, 0]

# flex_price = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
#               spot_price[11], spot_price[12], spot_price[13],
#               spot_price[14], spot_price[15], spot_price[16],
#               spot_price[17], spot_price[18], spot_price[19],
#               0, 0, 0, 0]


# Electrical load data
HSBelecLoad = [9.63000000000000, 10.4900000000000, 9.14000000000000, 8.40000000000000,
               9.37000000000000, 8.12000000000000, 9.40000000000000, 12.0800000000000,
               14.3000000000000, 15.1500000000000, 16.6600000000000, 16.1300000000000,
               15.3000000000000, 11.8500000000000, 11.9800000000000, 14.2300000000000,
               15.7900000000000, 17.9800000000000, 15.0500000000000, 16.0800000000000,
               13.8700000000000, 11.5900000000000, 8.89000000000000, 10.7100000000000]

# Heat load data
HSBheatLoad = [12.4803448300000, 12.2123333300000, 11.8865517200000, 11.5936666700000,
               11.3150000000000, 11.0182608700000, 10.7440740700000, 10.3885714300000,
               9.80900000000000, 9.74689655200000, 10.1250000000000, 10.5923333300000,
               11.2810344800000, 11.8136666700000, 12.1310000000000, 12.4350000000000,
               12.6665517200000, 12.9186666700000, 14.1130000000000, 14.0800000000000,
               13.4406666700000, 12.8168965500000, 12.3282758600000, 11.9440000000000]

# PV Generation data
HSBpvgen = [0, 0, 0, 0, 0, 0, 0.0600000000000000, 0.630000000000000, 2.02000000000000, 4.67000000000000,
            4.23000000000000, 7.35000000000000, 5.18000000000000, 2.67000000000000, 1.01000000000000,
            0.170000000000000, 0.0100000000000000, 0, 0, 0, 0, 0, 0, 0]

HSBelecloadHistData = [9.63000000000000, 10.4900000000000, 9.14000000000000, 8.40000000000000,
                       9.37000000000000, 8.12000000000000, 9.40000000000000, 12.0800000000000,
                       14.3000000000000, 15.1500000000000, 16.6600000000000, 16.1300000000000,
                       15.3000000000000, 11.8500000000000, 11.9800000000000, 14.2300000000000,
                       15.7900000000000, 17.9800000000000, 15.0500000000000, 16.0800000000000,
                       13.8700000000000, 11.5900000000000, 8.89000000000000, 10.7100000000000,
                       9.63000000000000, 10.4900000000000, 9.14000000000000, 8.40000000000000,
                       9.37000000000000, 8.12000000000000, 9.40000000000000, 12.0800000000000,
                       14.3000000000000, 15.1500000000000, 16.6600000000000, 16.1300000000000,
                       15.3000000000000, 11.8500000000000, 11.9800000000000, 14.2300000000000,
                       15.7900000000000, 17.9800000000000, 15.0500000000000, 16.0800000000000,
                       13.8700000000000, 11.5900000000000, 8.89000000000000, 10.7100000000000
                       ]
HSBheatloadHistData = [12.4803448300000, 12.2123333300000, 11.8865517200000, 11.5936666700000,
                       11.3150000000000, 11.0182608700000, 10.7440740700000, 10.3885714300000,
                       9.80900000000000, 9.74689655200000, 10.1250000000000, 10.5923333300000,
                       11.2810344800000, 11.8136666700000, 12.1310000000000, 12.4350000000000,
                       12.6665517200000, 12.9186666700000, 14.1130000000000, 14.0800000000000,
                       13.4406666700000, 12.8168965500000, 12.3282758600000, 11.9440000000000,
                       12.4803448300000, 12.2123333300000, 11.8865517200000, 11.5936666700000,
                       11.3150000000000, 11.0182608700000, 10.7440740700000, 10.3885714300000,
                       9.80900000000000, 9.74689655200000, 10.1250000000000, 10.5923333300000,
                       11.2810344800000, 11.8136666700000, 12.1310000000000, 12.4350000000000,
                       12.6665517200000, 12.9186666700000, 14.1130000000000, 14.0800000000000,
                       13.4406666700000, 12.8168965500000, 12.3282758600000, 11.9440000000000
                       ]

HSBpvgenHistData = [0, 0, 0, 0, 0, 0, 0.0600000000000000, 0.630000000000000, 2.02000000000000, 4.67000000000000,
                    4.23000000000000, 7.35000000000000, 5.18000000000000, 2.67000000000000, 1.01000000000000,
                    0.170000000000000, 0.0100000000000000, 0, 0, 0, 0, 0, 0, 0,
                    0, 0, 0, 0, 0, 0, 0.0600000000000000, 0.630000000000000, 2.02000000000000, 4.67000000000000,
                    4.23000000000000, 7.35000000000000, 5.18000000000000, 2.67000000000000, 1.01000000000000,
                    0.170000000000000, 0.0100000000000000, 0, 0, 0, 0, 0, 0, 0
                    ]
Spot_price = [0.221990000000000, 0.228250000000000, 0.218800000000000,
              0.207140000000000, 0.200660000000000, 0.193510000000000,
              0.208570000000000, 0.202200000000000, 0.220230000000000,
              0.235400000000000, 0.241890000000000, 0.284770000000000,
              0.507080000000000, 0.549960000000000, 0.439800000000000,
              0.253430000000000, 0.545680000000000, 1.04067000000000,
              1.48508000000000, 0.271790000000000, 0.212750000000000,
              0.205930000000000, 0.182300000000000, 0.159320000000000,
              0.221990000000000, 0.228250000000000, 0.218800000000000,
              0.207140000000000, 0.200660000000000, 0.193510000000000,
              0.208570000000000, 0.202200000000000, 0.220230000000000,
              0.235400000000000, 0.241890000000000, 0.284770000000000,
              0.507080000000000, 0.549960000000000, 0.439800000000000,
              0.253430000000000, 0.545680000000000, 1.04067000000000,
              1.48508000000000, 0.271790000000000, 0.212750000000000,
              0.205930000000000, 0.182300000000000, 0.159320000000000
              ]
Flex_price = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
              sum(spot_price) / 24, sum(spot_price) / 24, sum(spot_price) / 24,
              sum(spot_price) / 24, sum(spot_price) / 24, sum(spot_price) / 24,
              sum(spot_price) / 24, sum(spot_price) / 24, sum(spot_price) / 24,
              0, 0, 0, 0,
              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
              sum(spot_price) / 24, sum(spot_price) / 24, sum(spot_price) / 24,
              sum(spot_price) / 24, sum(spot_price) / 24, sum(spot_price) / 24,
              sum(spot_price) / 24, sum(spot_price) / 24, sum(spot_price) / 24,
              0, 0, 0, 0
              ]

for t in range(24):
    HSBelecloadPredict = HSBelecloadHistData[t:t + 24]
    HSBheatloadPredict = HSBheatloadHistData[t:t + 24]
    HSBpvgenPredict = HSBpvgenHistData[t:t + 24]
    Spot_pricePredict = Spot_price[t:t + 24]
    Flex_pricePredict = Flex_price[t:t + 24]

    scheduling = []

    if t < 8:
        scheduling.append(
            EMSEnergyfunc(HSBelecLoad=HSBelecloadPredict, HSBheatLoad=HSBheatloadPredict, HSBpvgen=HSBpvgenPredict,
                          spot_price=Spot_pricePredict))
    elif t == 8:
        Pgrid_imp0 = abs(
            EMSEnergyfunc(HSBelecLoad=HSBelecloadPredict, HSBheatLoad=HSBheatloadPredict, HSBpvgen=HSBpvgenPredict,
                          spot_price=Spot_pricePredict).iloc[0, :]).T
        scheduling.append(
            EMSFLEXfunc(HSBelecLoad=HSBelecloadPredict, HSBheatLoad=HSBheatloadPredict, HSBpvgen=HSBpvgenPredict,
                        spot_price=Spot_pricePredict, flex_price=Flex_pricePredict, pGridim0=Pgrid_imp0))
        flex_value = scheduling[-1].iloc[-1, :].T
    elif 8 < t <= 20:
        scheduling.append(EMSFLEX_providefunc(HSBelecLoad=HSBelecloadPredict, HSBheatLoad=HSBheatloadPredict,
                                              HSBpvgen=HSBpvgenPredict,
                                              spot_price=Spot_pricePredict, pGridim0=Pgrid_imp0, Flex=flex_value))
    else:
        scheduling.append(
            EMSEnergyfunc(HSBelecLoad=HSBelecloadPredict, HSBheatLoad=HSBheatloadPredict, HSBpvgen=HSBpvgenPredict,
                          spot_price=Spot_pricePredict))
